# rewards_config.yaml - Balatro Poker RL Reward Configuration
# Dense Normalized Reward Structure for Better Learning
# All rewards normalized to roughly [-1, 1] scale with frequent feedback

# Terminal Outcomes - Normalized and balanced
outcome:
  win_bonus: 1.0              # Base reward for winning
  loss_penalty: 1.0            # Symmetric penalty for losing

# Efficiency Rewards
# Encourage winning quickly and conserving plays
efficiency:
  play_conservation_bonus: 0.25  # Bonus PER UNUSED play (max 1.0 for all 4 plays)
  step_penalty: 0.02             # Small per-action cost (~0.1 for typical episode)

# Incremental Progress Rewards
# Dense feedback based on chip accumulation
progress:
  chip_gain_scale: 1.0
  chip_normalization: 300        # Normalize to target score (300 chips = +1.0 reward)
                                  # Makes incremental progress much more important

  # Milestone bonuses when crossing percentage thresholds of target score
  target_threshold_bonuses:
    - threshold: 0.75           # Reaching 225/300 chips
      bonus: 0.25
    - threshold: 0.90           # Reaching 270/300 chips
      bonus: 0.5

# Hand Recognition Rewards
# Small bonuses for playing stronger poker hands (encourages learning hand evaluation)
# Keep these small so chip values remain primary signal
hand_quality:
  enabled: true
  bonuses:
    high_card: 0.0              # Tier 1 (weakest hand)
    pair: 0.01
    two_pair: 0.02
    three_of_a_kind: 0.03
    straight: 0.04
    flush: 0.05
    full_house: 0.06
    four_of_a_kind: 0.08
    straight_flush: 0.10        # Tier 9 (strongest hand)

# Penalties
# Discourage undesirable behaviors
penalties:
  desperate_play: 0.2           # Penalty for playing High Card when plays_left < 2 and far from target
  desperate_threshold: 0.5      # "Far from target" = less than this fraction of target score

# Discard Shaping
# Reward strategic discarding to encourage the agent to use discards effectively
discard_shaping:
  enabled: true
  smart_discard_bonus: 0.25     # Reward for discarding when hand is weak
  draw_chase_bonus: 0.15        # Extra bonus when chasing flush/straight draw
  weak_hand_play_penalty: 0.15  # Penalty for playing weak hand when discards available
  weak_hand_threshold: 2        # Hand types < this are "weak" (0=HC, 1=Pair, 2=TwoPair)
  # Hand improvement rewards (after discard)
  hand_improvement_scale: 0.10  # Reward per hand type level improved
  hand_improvement_max: 0.50    # Cap on improvement reward (5 levels max)
  # Doomed play penalty (playing last hand when discards left and can't win)
  doomed_play_penalty: 0.5      # Penalty for wasting last play when discards unused
  # Valuable hand discard penalty (discarding strong hands)
  valuable_hand_discard_penalty: 0.20  # Penalty for discarding Straight or better
  valuable_hand_threshold: 4    # Hands >= this are "valuable" (4=Straight, 5=Flush, etc.)
  # Unused discards penalty at episode loss
  unused_discards_penalty: 1.67 # Penalty per unused discard at loss (~5.0 for 3 discards)

# Advanced Shaping (Optional)
# These features can be enabled for more sophisticated reward engineering
advanced:
  # Reward winning with safety margin (beating target by large amount)
  safety_margin_bonus:
    enabled: true
    per_chip_over_target: 0.1   # Bonus per chip over target (e.g., 50 chips over = +5 reward)
    max_bonus: 100              # Cap the maximum safety margin bonus

  # Exploration bonuses (encourage trying diverse actions)
  exploration:
    enabled: true
    action_diversity_bonus: 5   # Bonus for using different action types in episode

# Metadata
version: "v0"                   # Reward config version (matches game ruleset version)
description: "Conservative efficiency-focused reward scheme. Heavily rewards play conservation, neutral on risk-taking, no discard penalties."
